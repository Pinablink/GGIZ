;----------------------------------------------------------------------------------------------
#include "msp430g2553.h"
;----------------------------------------------------------------------------------------------
        EXTERN DELAY_50MS
        NAME   SIGNAL_PROCEDURE
        PUBLIC SIGNAL_INT,SIGNAL_ALERT,SIGNAL_PRESS_BUTTON,SIGNAL_WAIT
        RSEG   CODE           
;----------------------------------------------------------------------------------------------
;----------------------------------------------------------------------------------------------
SIGNAL_INT ; PROCESSA UM SINAL INDICATIVO DE QUE O HARDWARE FOI INICIALIZADO
;----------------------------------------------------------------------------------------------
         PUSH.W  R6
         PUSH.W  R4
         MOV.W   #00000h,R6
         MOV.B   #004h,R6
CLOOP1:  CMP.W   #00000h,R6
         JEQ     ESIGNAL
         CALL    #BEEP_CTR
         MOV.W   #000C8h,R4
         CALL    #DELAY_50MS
         DEC.B   R6
         JMP     CLOOP1     
ESIGNAL: POP.W   R4
         POP.W   R6
         RET
;----------------------------------------------------------------------------------------------
;----------------------------------------------------------------------------------------------
SIGNAL_ALERT ; PROCESSA UM SINAL INDICATIVO DE ALERTA
;----------------------------------------------------------------------------------------------
         PUSH.W  R6
         PUSH.W  R4
         MOV.W   #00000h,R6
         MOV.B   #00Ah,R6
CLOOP2:  CMP.W   #00000h,R6
         JEQ     ESIG1
         CALL    #BEEP_CTR
         MOV.W   #00064h,R4
         CALL    #DELAY_50MS
         DEC.B   R6
         JMP     CLOOP2     
ESIG1:   POP.W   R4
         POP.W   R6
         RET
;----------------------------------------------------------------------------------------------
;----------------------------------------------------------------------------------------------
SIGNAL_WAIT ; PROCESSA UM SINAL INDICATIVO DE ALERTA
;----------------------------------------------------------------------------------------------
         PUSH.W  R6
         PUSH.W  R4
         MOV.W   #00000h,R6
         MOV.B   #00Ah,R6
WCLOOP2: CMP.W   #00000h,R6
         JEQ     WESIG1
         CALL    #BEEP_CTR
         MOV.W   #001F4h,R4
         CALL    #DELAY_50MS
         DEC.B   R6
         JMP     WCLOOP2     
WESIG1:  POP.W   R4
         POP.W   R6
         RET
;----------------------------------------------------------------------------------------------
;----------------------------------------------------------------------------------------------
SIGNAL_PRESS_BUTTON
;----------------------------------------------------------------------------------------------
         PUSH.W  R4 
         MOV.W   #00019h,R4
         CALL    #BEEP_CTR
         CALL    #DELAY_50MS
         CALL    #BEEP_CTR
         POP.W   R4
         RET
;----------------------------------------------------------------------------------------------
;----------------------------------------------------------------------------------------------
BEEP_CTR ; CONTROLA O BEEP
;----------------------------------------------------------------------------------------------
         BIT.B   #BIT4,&P1OUT
         JZ      BEEPOFF 
BEEPON:  BIC.B   #BIT4,&P1OUT
         JMP     EBEEP       
BEEPOFF: BIS.B   #BIT4,&P1OUT        
EBEEP:   RET
;----------------------------------------------------------------------------------------------
        END  
;----------------------------------------------------------------------------------------------