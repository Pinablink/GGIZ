/*
Autor: Weber Alves dos Santos (Pinablink)

*/
;----------------------------------------------------------------------------------------------
#include "msp430g2553.h"
#include "/../header/ggiz_header.h"
;----------------------------------------------------------------------------------------------
        NAME   SERIAL_COM
        PUBLIC SEND_HELLO
        EXTERN LOAD_HELLO_MSG
        RSEG   CODE           
;----------------------------------------------------------------------------------------------
SEND_HELLO ; ENVIA UM COMANDO PARA O MÓDULO WIFI PARA TESTAR SUA CAPACIDADE DE OPERAÇÃO
;----------------------------------------------------------------------------------------------
          PUSH.W    WORD
          PUSH.W    LEN_WORD
          CALL      #LOAD_HELLO_MSG
ITER_0:   CALL      #TX_SEND       
          DEC.B     LEN_WORD
          TST.B     LEN_WORD
          JNZ       ITER_0
          POP.W     LEN_WORD
          POP.W     WORD
          RET
;----------------------------------------------------------------------------------------------
TX_SEND
;----------------------------------------------------------------------------------------------
_BUSY:   BIT.B       #UCBUSY,&UCA0STAT 
         JNZ         _BUSY                    
         MOV.B       @WORD+,UCA0TXBUF
         BIS.B       #UCA0TXIFG,&IFG2 ; LIBERA A FLAG PARA COMUNICAÇÃO                    
         RET
;----------------------------------------------------------------------------------------------
;----------------------------------------------------------------------------------------------
        END  
;----------------------------------------------------------------------------------------------